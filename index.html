<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caleidoscopio</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/lib/addons/p5.dom.min.js"></script>
    <style>
        html, body {
            height: 100%; 
            margin: 0;
            box-sizing: border-box; 
        }
        *, *:before, *:after { 
            box-sizing: inherit;
        }

        body {
            font-family: Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: #000000; 
            color: #FFFFFF; 
            font-size: 12pt; 
            display: flex; 
            flex-direction: column;
            min-height: 100vh;
            overflow-x: hidden; 
        }
        body.simulation-fullscreen { 
            overflow: hidden !important; 
        }
        .main-content-area { 
            overflow-y: auto;  
        }

        .immagine-container {
        text-align: center; 
        }

        .immagine {
        display: inline-block; 
        margin: 0 10px; 
        width: 30%; 
        height: auto; 
        }


        nav.top-menu {
            background-color: rgba(10, 10, 10, 0.85); 
            backdrop-filter: blur(5px); 
            -webkit-backdrop-filter: blur(5px);
            width: 100%;
            position: sticky; 
            top: 0; 
            z-index: 1000;
            flex-shrink: 0;
            padding: 8px 0; 
            border-bottom: 1px solid #333333; 
            transition: top 0.3s ease-in-out; 
        }

        nav.top-menu ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            display: flex;
            width: 100%;
        }

        nav.top-menu li {
            flex-grow: 1; 
        }

        nav.top-menu li a {
            display: block; 
            color: #E0E0E0; 
            text-align: center; 
            padding: 18px 15px; 
            text-decoration: none;
            font-weight: normal; 
            text-transform: none;
            letter-spacing: normal;
            transition: color 0.3s ease, border-bottom-color 0.3s ease, background-color 0.3s ease;
            cursor: pointer;
            border-bottom: 2px solid transparent; 
            font-size: 10pt; 
        }

        nav.top-menu li a:hover,
        nav.top-menu li a.active {
            color: #FFFFFF; 
            border-bottom-color: #FFFFFF; 
            background-color: rgba(255, 255, 255, 0.1); 
        }
        
        .page-title-container { 
            width: 100%;
            text-align: center;
            padding: 20px 10px 10px 10px; 
            flex-shrink: 0;
            display: none; 
        }
        .page-title-container h1 {
            color: #FFFFFF; 
            margin: 0;
            font-size: 2.0em; 
        }

        .main-content-area {
            flex-grow: 1;
            width: 100%;
            display: flex; 
            flex-direction: column;
            align-items: center;
        }
        
        #simulationContainer { 
            display: none; 
            flex-direction: column; 
            align-items: center;
            justify-content: flex-start; 
            width: 100%;
            height: 100%; 
        }

        #kaleidoscopeCanvas { 
            box-shadow: 0px 0px 20px rgba(200, 200, 200, 0.3);
            max-width: 100%;
            height: auto;
        }
        
        #homePageTitle { 
            display: none; 
            text-align: center;
            padding: 15px 10px; 
            width: 100%;
            flex-shrink: 0; 
        }
        #homePageTitle h1 {
            color: #FFFFFF;
            margin: 0;
            font-size: 2.2em; 
        }

        .content-section {
            display: none; 
            padding: 20px; 
            margin: 0 auto 20px auto; 
            width: 95%;  
            max-width: 800px; 
            background-color: transparent; 
        }
        .content-section h2, .content-section h3, .content-section h4 {
            color: #E0E0E0; 
            border-bottom: 2px solid #777777; 
            padding-bottom: 10px; 
            margin-top: 20px; 
            font-size: 1.5em; 
        }
         .content-section h3 { font-size: 1.3em; border-bottom-style: dashed; }
         .content-section h4 { 
            font-size: 1.1em; 
            border-bottom-style: dotted; 
            margin-top: 15px; 
            margin-bottom: 10px;
            color: #CCCCCC; 
        }

        #argomento4 p {
            text-align: left;
            margin-bottom: 10px;
        }
        a { 
            color: #8ab4f8; 
            text-decoration: none;
        }
        #argomento4 a:hover {
            text-decoration: underline;
        }
        
        /* Stile per l'iframe nella sezione tassellatura */
        #argomentoTassellatura iframe {
            border: none; /* Rimuove il bordo */
            width: 100%; /* Occupa la larghezza del contenitore .content-section */
            max-width: 900px; /* Mantiene la tua larghezza massima specificata */
            height: 700px; /* Mantiene la tua altezza specificata */
            display: block; /* Per gestire margini e centratura */
            margin: 20px auto; /* Centra l'iframe se il contenitore è più largo */
        }


        /* Stili per i Laboratori p5.js */
        #p5LabContainer, #p5StellaLab { 
            display: flex;
            flex-direction: column; 
            align-items: center; 
            gap: 15px;
            margin-top: 10px; 
            width: 95%; 
            max-width: 700px;
            padding: 10px; 
            background-color: #000000; 
            border-radius: 8px;
            margin-bottom: 20px;
        }
        #p5StellaLab { 
             background-color: transparent; 
             padding: 0; 
             border-radius: 0;
             box-shadow: none; 
             margin-top: 25px; 
             margin-bottom: 25px; 
        }

        #p5CanvasContainer, #p5StellaCanvasContainer { 
            box-shadow: 0 0 10px rgba(255,255,255,0.1); 
            flex-shrink: 0; 
            width: 100%; 
            display: flex; 
            justify-content: center;
        }
        #p5CanvasContainer canvas, #p5StellaCanvasContainer canvas {
            max-width: 100%; 
            height: auto !important; 
        }

        #controls-container-p5, #p5StellaControlsContainer { 
            padding: 10px; 
            background-color: #1C1C1C; 
            border-radius: 5px;
            display: flex;
            flex-direction: column; 
            align-items: stretch;  
            gap: 15px; 
            width: 100%; 
            max-width: 500px; 
            color: #D0D0D0; 
        }
        #p5StellaControlsContainer { 
            background-color: #1C1C1C; 
            box-shadow: none;
            align-items: center; 
        }
        #p5StellaControlsContainer .control-group {
            justify-content: center;
            width: auto; 
            flex-direction: row; 
        }


        #controls-container-p5 .control-group, #p5StellaControlsContainer .control-group {
            display: flex;
            flex-direction: column; 
            align-items: flex-start;
            gap: 5px; 
        }
        #controls-container-p5 .control-group label, 
        #p5StellaControlsContainer p, 
        #p5StellaControlsContainer span { 
            font-weight: normal; 
            margin: 0 0 5px 0; 
            text-align: left;
            color: #D0D0D0;
            width: 100%; 
        }
        #controls-container-p5 .slider-container, #p5StellaControlsContainer .slider-container { 
            display: flex;
            align-items: center;
            gap: 8px;
            flex-grow: 1;
            width: 100%; 
        }
        #controls-container-p5 input[type="range"], #p5StellaControlsContainer input[type="range"] {
            flex-grow: 1;
            min-width: 100px; 
            border: none; outline: none; padding: 0; 
        }
        #controls-container-p5 .control-group span, #p5StellaControlsContainer span.value-display { 
            min-width: 25px; 
            text-align: right;
            font-weight: normal;
        }
         #controls-container-p5 input[type="color"], #p5StellaControlsContainer input[type="color"] {
            width: 35px; height: 25px; padding: 0; border: 1px solid #444;
            background: none; 
            margin-left: 0; 
        }
        #controls-container-p5 #instructions, #p5StellaLab #instructions-p5, #p5TessellationLabContainer #instructions-tessellation {
            margin-top: 5px;
            font-style: italic;
            font-size: 0.9em;
            color: #aaa;
            width: 100%; text-align: center;
        }

        footer {
            text-align: center; padding: 25px 20px;
            background-color: #111111; 
            color: #E0E0E0; 
            width: 100%;
            flex-shrink: 0;
            margin-top: 30px;
            border-top: 1px solid #333333; 
            font-size: 10pt; 
            display: none; 
        }

        html { scroll-behavior: smooth; }

        /* Media Queries per Responsiveness */
        @media (max-width: 768px) {
            body {
                font-size: 11pt; 
            }
            nav.top-menu li a {
                padding: 14px 8px; 
                font-size: 9pt;
            }
            .page-title-container h1 {
                font-size: 1.8em;
            }
            #homePageTitle h1 {
                font-size: 2em;
            }
            .content-section h2 { font-size: 1.4em; }
            .content-section h3 { font-size: 1.2em; }
            .content-section h4 { font-size: 1.0em; }
            
            .immagine { 
                 max-width: 150px;
            }
            #argomentoTassellatura iframe { /* Rendi l'iframe più piccolo su mobile */
                height: 400px;
                max-width: 90%;
            }
        }

        @media (min-width: 600px) { 
            #controls-container-p5 { 
                flex-direction: row;
                flex-wrap: wrap; 
                align-items: center;
                justify-content: space-around; 
            }
            #controls-container-p5 .control-group {
                flex-direction: row; 
                align-items: center;
                width: auto; 
                flex-basis: 45%; 
            }
            #controls-container-p5 .control-group label{
                 margin-bottom: 0;
                 width: auto; 
                 margin-right: 5px;
             }
             #controls-container-p5 input[type="color"] {
                margin-left: auto; 
            }
            
            .immagine-container { 
                justify-content: space-around;
            }
            .immagine {
                 width: 30%; 
                 margin: 0 5px;
            }
        }

        @media (max-width: 480px) {
            nav.top-menu li a {
                padding: 12px 5px;
                font-size: 8pt;
            }
             .page-title-container h1 {
                font-size: 1.6em;
            }
            #homePageTitle h1 {
                font-size: 1.8em;
            }
             .content-section h2 { font-size: 1.3em; }
             .content-section h3 { font-size: 1.1em; }
             .content-section h4 { font-size: 1.0em; }

            .immagine { 
                 max-width: 120px;
            }
            #p5StellaControlsContainer .control-group { 
                 flex-direction: column;
                 align-items: center;
            }
            #p5StellaControlsContainer p {
                margin-bottom: 5px;
            }
            #argomentoTassellatura iframe {
                height: 300px;
            }
        }

    </style>
</head>
<body>
    <nav class="top-menu">
        <ul>
            <li><a data-target="simulationContainer" class="active">Home</a></li>
            <li><a data-target="argomento1">Cos'è e come funziona</a></li>
            <li><a data-target="argomento2">Simmetrie</a></li>
            <li><a data-target="argomentoTassellatura">Tassellatura</a></li> 
            <li><a data-target="argomento3">Laboratorio</a></li> 
            <li><a data-target="argomento4">About</a></li>
        </ul>
    </nav>
    
    <div class="main-content-area">
        <div id="simulationContainer">
            <canvas id="kaleidoscopeCanvas"></canvas>
            <div id="homePageTitle"> 
                 <h1>CALEIDOSCOPIO</h1>
            </div>
        </div>

        <section id="argomento1" class="content-section">
            <h2>Cos'è un caleidoscopio?</h2>
            <p>Il termine deriva dal greco καλός "bello", εἶδος "immagine", e σκοπέω, "guardare". Il caleidoscopio è uno strumento ottico che, attraverso una serie di specchi inclinati, crea una molteplicità di immagini simmetriche a partire da piccoli oggetti colorati posti al suo interno.  </p>
            <p>Inventato da <a href="https://it.wikipedia.org/wiki/David_Brewster">David Brewster</a>, il caleidoscopio è diventato rapidamente un giocattolo popolare, ma ha anche trovato applicazioni nell'arte e nel design per la sua capacità di generare pattern complessi e affascinanti.</p>
            <p>Il caleidoscopio sfrutta il principio della riflessione tra specchi, conosciuto già dall’ottica classica, ma fu inventato come oggetto nel 1816. Venne brevettato l’anno successivo. Esso è costituito da tre specchi inseriti in un tubo con un buco ad un’estremità e dei vetrini colorati in un doppio fondo dall’altra parte. 
                <br> La costruzione del caleidoscopio venne programmata per il 1817 ma prima che l’oggetto potesse uscire l’idea venne copiata e l’uscita preceduta a Londra e Parigi.</p>
       
            <h2>Come funziona?</h2>
            <p>Il principio di funzionamento di un caleidoscopio si basa sulla riflessione multipla della luce. Comunemente, si usano tre specchi disposti a formare un prisma a base triangolare equilatera.</p>
            <p>Ad un'estremità del tubo si trova una camera traslucida contenente piccoli frammenti colorati. La luce che attraversa questi oggetti viene riflessa dagli specchi, creando un pattern simmetrico. Ruotando il tubo, gli oggetti si muovono, generando nuove configurazioni. </p>
            <p>Solitamente il numero di specchi impiegati è tre, disposti a triangolo equilatero in modo da formare la seguente sequenza di angoli: 60°-60°-60° (ma in realtà sono possibili altre due combinazioni: 45°-45°-90° e 30°-60°-90°).</p>
            
         
            <div class="immagine-container">
                <img src="equilatero.png" alt="60°-60°-60°" class="immagine" title="https://en.etudes.ru/etudes/kaleidoscope/">
                <img src="isoscele.jpg" alt="45°-45°-90°" class="immagine" title="https://en.etudes.ru/etudes/kaleidoscope/">
                <img src="scaleno.png" alt="30°-60°-90°" class="immagine" title="https://en.etudes.ru/etudes/kaleidoscope/">
              </div>
            <p style="text-align: center;">
                Da sinistra a destra: 60°-60°-60°;   45°-45°-90°;   30°-60°-90°
            </p>

        </section>
        <section id="argomento2" class="content-section">

            <h2>Le simmetrie</h2> 
            <p>L’immagine del caleidoscopio è originata dalla continua riflessione dei frammenti colorati tra uno specchio e l’altro, moltiplicati in modo apparentemente perfetto. Il processo è quello di una simmetria centrale, e ovviamente il numero delle riflessioni dipende dagli angoli tra gli specchi, che di solito formano un prisma a base triangolare isoscele, riflettente all’interno. Le simmetrie delle forme in movimento del caleidoscopio sono il risultato dell’intersezione dello studio delle riflessioni con quello delle simmetrie centrali, che tante applicazioni hanno prodotto nell’architettura e nelle arti, ma ancora di più nella decorazione degli oggetti.</p>
            
            <div id="p5StellaLab">
               
                <div id="p5StellaControlsContainer">
                    </div>
                <div id="p5StellaCanvasContainer" style="margin-top:10px;">
                    </div>
                 <p id="instructions-p5" style="font-style: italic; font-size: 0.9em; color: #aaa; text-align:center; margin-top:5px;">Usa lo slider per cambiare le punte. Al diminuire dell'angolo le simmetrie aumentano.</p>
            </div>

            <p>Ma cos’è una simmetria?
            <br>
            <br>
            Il termine simmetria, dal greco συμμετρια è sinonimo di "giusta proporzione" o anche "proprietà geometrica di solidi e di esseri viventi". Nel linguaggio comune, quando si parla di simmetrie si è soliti riferirsi a quella che in matematica viene chiamata "simmetria bilaterale" ovvero una figura è simmetrica se posso dividerla in due parti uguali e speculari. Ma questa concezione è stata generalizzata, dando alla parola simmetria un più ampio significato geometrico, ovvero aggiungendo alla semplice simmetria, diciamo a specchio, tutti i possibili movimenti che riportano una figura in se stessa. È proprio in questi termini che un gruppo di movimenti rigidi descrive esattamente la simmetria di una figura e, viceversa, attraverso una figura posso visualizzare gli elementi di un gruppo di isometrie. <br>
            Il gruppo di simmetrie di una figura è l’insieme dei movimenti, appunto delle simmetrie, che riportano la figura su se stessa, rendendola intera. </p>
            <p>
            <strong> Simmetria: </strong> <br>
            Consideriamo una figura F del piano E2 ed ƒ appartenente a M.<br>
            Se ƒ è tale che ƒ(F) = F (cioè ƒ è un'isometria che riporta la figura in se stessa), allora ƒ si dice simmetria di F.</p>
            <p>
            <br>
            <div style="text-align: center;">
                <img width="600px" src="simmetriaRadiale.png" alt="Simmetria radiale">
            </div>
            <br>
            <strong>Gruppo di simmetrie:</strong><br>
            Tutte le simmetrie di F formano un gruppo chiamato gruppo di simmetria di F e denotato con Isom(F): Isom(F) = { ƒ  M | ƒ(F) = F } 
            <br>
            <br>
            Il tipo di gruppo di simmetrie di una figura ci permette di stabilire il tipo della simmetria della figura presa in esame: per spiegare la matematica dietro il caleidoscopio i gruppi di simmetrie presi maggiormente in considerazione sono i gruppi ciclici e i gruppi diedrali.</p>
            <p>
            <strong> Gruppo ciclico:</strong> <br>
            Il gruppo ciclico Cn In matematica, più precisamente nella teoria dei gruppi, è un gruppo generato da un unico elemento. Un gruppo C è ciclico se esiste un elemento c del gruppo (detto generatore) tale che C è l’insieme delle potenze di c ad esponente intero.
            <br>
            <br>
            Il gruppo ciclico di ordine n :
            <br>
            <br>
            Cn = < ρ2π/n > = { 1, ρθ, ρθ2, ... , ρθn-1}
            <br>
            <br>
            Ogni gruppo di simmetrie ha un proprio dominio fondamentale.<br>
            Il dominio fondamentale di un gruppo di simmetrie corrisponde alla parte minima di una figura F che, presa singolarmente, permette di riprodurre tutti i movimenti Isom(F). Una volta individuato, ricaviamo l’ordine del gruppo (il numero di elementi che il gruppo contiene e quindi ciò che ne definisce la grandezza) contando quante volte il dominio fondamentale si ripete nella figura.
            </p>
            <p>
            <strong> Gruppo Zn:</strong><br>
            Il gruppo Zn è un insieme di classi di resto di modulo n ed è un gruppo di tipo abeliano con l’operazione di somma modulo n. Ogni elemento di Zn è una classe di resto, che rappresenta tutti i numeri interi che forniscono lo stesso resto quando divisi per n.<br>
            L’addizione nel gruppo Zn si fa eseguendo la somma come in Z e poi prendendo il resto della divisione per n.<br>
            Se n = 5, allora Zn è costituito da {0, 1, 2, 3, 4}. L'operazione è la somma modulo 5:
            <br>
            <br>
            2 + 3 = 5, che ridotto modulo 5 diventa 0. Quindi in Zn, 2 + 3 = 0. <br>
            1 + 4 = 5, che ridotto modulo 5 diventa 0. Quindi in Zn, 1 + 4 = 0. <br>
            2 + 2 = 4, quindi in Zn, 2 + 2 = 4. <br>
            <br>
            <br>
            Di conseguenza Zn = {[0] ,[1] , [2] , ... , [n-1]}.</p>
            <p>
            <strong>Isomorfismo tra gruppi:</strong><br>
            Un isomorfismo tra gruppi è una corrispondenza biunivoca tra gli insiemi sostegno (elementi che costituiscono il gruppo) di due gruppi che conserva le uguaglianze riguardanti le operazioni caratterizzanti i due gruppi.
            <br>
            <br>
            Per ogni n ≥ 1 esiste un isomorfismo di gruppi fra Zn e Cn. Consideriamo ρ2π/n elemento generatore di Cn, i = 0 , 1 , ... , n - 1, e costruiamo la seguente applicazione:
            <br>
            <br>
            ƒ : Cn → Zn = (ρ2π/n)i → [ i ]
            <br>
            <br>
            ƒ è un isomorfismo di gruppi infatti:<br>
            ƒ ( ρ2π/nn o ρ2π/nm) = ƒ ( ρ2π/nn + m) = [n + m] = [n] + [m]= ƒ ( ρ2π/nn ) + ( ρ2π/nm)
            <br>
            <br>
            In termini più semplici questa proposizione dimostra che è possibile identificare Zn con Cn in quanto hanno lo stesso ordine ed intercorrono le stesse relazioni fra i generatori e gli elementi dei relativi gruppi.
            Quest'ultima caratteristica deve essere sempre tenuta in considerazione quando si confrontano due gruppi. </p>
            <br>
            <br>
            <strong>Gruppo diedrale di ordine 2n: </strong> <br>
            I gruppi diedrali di ordine 2n sono gruppi formati dalle isometrie dei poligoni regolari a n lati. 
            <br>
            <br>
            L'aggettivo diedrale deriva dal termine diedro (dal greco "solido a due facce"), che a sua volta discende dal fatto di voler considerare un poligono come un solido degenere ad altezza nulla.
            <br>
            <br>
            Osservazione: <br>
            Prima di studiare un gruppo Dn attraverso una figura di cui è gruppo di simmetria, come si è fatto per i gruppi ciclici, è importante osservare la seguente uguaglianza: 
            <br>
            <br>
            ρθ o rl = rt
            <br>
            <br>
            Ovvero una riflessione di asse l composta con una rotazione di angolo θ corrisponde ad un'altra riflessione di un nuovo asse t. Di conseguenza un elemento di Dn del tipo ρθm o rl può anche essere visto come una riflessione data da una nuova retta. Se Dn = Isom(F) per una qualche figura, tali rette sono tutti i suoi possibili assi di simmetria.<br>
            In conclusione Dn è un gruppo formato da n rotazioni e n riflessioni.
            <br>
            <br>
            Dn = < ρ2π/n , rl > = { 1, ρθ, ρθ2, ... , ρθn-1 , rl , ρθ o rl , ρθ2 o rl , ... , ρθn-1 o rl } </p>
            <br>
            <br>
            
            
            
        </section>

        <section id="argomentoTassellatura" class="content-section">
            <h2>Tassellatura e Caleidoscopi</h2>
        <p>
            Parlando di riflessioni e simmetrie, un elemento fondamentale del principio del caleidoscopio è quello della tassellatura, ossia coprire un intero piano ripetendo una sola figura senza alcuna sovrapposizione e nessuno spazio bianco.
        </p>
        <p> 
            Tali figure geometriche, (dette appunto "tasselli"), sono spesso poligoni, regolari o non, che possono anche avere lati curvilinei.
        </p>
        <p> Ci si può rendere conto che non tutti i poligoni regolari tassellano il piano. Infatti, non è possibile tassellare con pentagoni, perché l’angolo di un pentagono regolare non è un sottomultiplo di 360°, condizione necessaria, per non lasciare lacune nell’intorno dei vertici.

                Alcuni esempi di poligoni con la quale è possibile tassellare il piano sono triangolo, quadrato ed esagono, mentre con un pentagono è impossibile eseguire la tassellazione poiché la somma dei suoi angoli da come risultato 108°. 
        </p>


            <br>
            <br>
            <br>
            <div style="text-align: center;">
            <img width="600px" src="tassellazione.png">
        </div>
        <br>
        <p>La tassellatura può essere regolare e irregolare. Come abbiamo già detto, i soli poligoni con la quale è possibile tassellare regolarmente il piano sono triangolo, quadrato ed esagono, ma si può tassellare il piano anche con due o più poligoni regolari, ottenendo diverse configurazioni.
        </p>
        <p> 
        Esistono tassellature periodiche e aperiodiche.
        <br>   
        Una tassellatura periodica è una disposizione di figure geometriche (come poligoni) su un piano in modo tale che la disposizione si ripeta regolarmente.
            Invece, una tassellatura aperiodica è una disposizione di figure che non si ripete in alcun modo regolare, pur essendo ordinata e coesa.
        </p> 
        <div style="text-align: center; margin-top: 20px;">
            <iframe class="tassellazione-iframe" height="700px" width="900px" src="tassellatura_giusta/index.html"></iframe>
        </div>
            
       
        </section>
        
        <section id="argomento3" class="content-section">
            <h2>La matematica del caleidoscopio</h2> 
            <p>Un modo pratico per creare una figura F con Isom(F) = Dn è il Caleidoscopio: un qualsiasi oggetto posto fra i suoi specchi si riflette più volte creando un'immagine che può essere considerata una figura del piano euclideo. 
                <br>
                Con questo laboratorio vedremo come il numero e il tipo di riflessioni dell'oggetto all'interno del caleidoscopio non sono casuali, ma dipendono da regole ben precise. Inoltre potremo notare come, scegliendo particolari angoli, le figure generate dagli specchi avranno come gruppo di simmetria un gruppo diedrale Dn.
                <br>
                <br>
Dn è il gruppo generato da una rotazione ρ2π/n e da una riflessione rl di asse l (), ma come accade per la maggior parte dei gruppi generati, non è indispensabile scegliere proprio questi due elementi. Infatti se θ = 2π/n è l'angolo della rotazione generatrice, sia s la retta per l'origine tale che se ruotiamo s di θ/2 (nel verso positivo degli angoli) intorno all'origine s si sovrappone ad l; allora si ha che: ρθ = rl º rs.
Di conseguenza si può considerare Dn generato da queste due riflessioni. 
</p>

<p>
<strong>Caleidoscopio modello del gruppo diedrale:</strong><br>
Consideriamo due rette per l'origine l, s, e l'angolo α che esse delimitano, con la condizione che esista n appartenente a N tale che: α = π/n
</p>
<div style="text-align: center;">
<img height="500px" width="500px" src="immagine_assi.png">
</div>

<p>

Abbiamo appena visto che Dn = < ρ2π/n, rl > = < rl , rs >
</p>

 <p>
<br>
<br>
 Disegna sul canvas sottostante. Modifica il numero di "spicchi" (riflessioni), il colore e lo spessore del tratto per vedere come cambiano i pattern caleidoscopici. 
 <br> Premi SPAZIO per pulire il disegno.</p>
            <div id="p5LabContainer" > 
    <div id="controls-container-p5">
                    <div class="control-group" id="numSpicchiControl-labMain">
                        <label for="numSpicchiSlider-labMain">Numero sezioni:</label>
                        <div class="slider-container">
                            <input type="range" id="numSpicchiSlider-labMain"> <span id="numSpicchiDisplay-labMain">6</span>
                        </div>
                    </div>
                     <div class="control-group" id="angleDisplayControl-labMain">
                        <label>Angolo:</label> <span id="bisectorAngleDisplay-labMain">60°</span>
                    </div>
                    <div class="control-group" id="colorPickerControl-labMain">
                        <label for="colorPickerInput-labMain">Colore disegno:</label>
                        <input type="color" id="colorPickerInput-labMain"> 
                    </div>
                    <div class="control-group" id="strokeWeightControl-labMain">
                        <label for="strokeWeightSlider-labMain">Spessore tratto:</label>
                        <div class="slider-container">
                            <input type="range" id="strokeWeightSlider-labMain">
                            <span id="strokeWeightDisplay-labMain">4</span>
                        </div>
                    </div>
                    <div id="instructions-labMain"><p><em>Premi SPAZIO per pulire il disegno.</em></p></div>
                </div>
                <div id="p5CanvasContainer" style="margin-top:15px;"></div>
            </div>

       
<p style="margin-top: 20px;">
Ogni oggetto T1 posto fra i due specchi produce 2n-1 immagini visibili ( T2 , ... , T2n ), separate nel disegno attraverso n rette.
<br>
Guardando il caleidoscopio dall'alto, l'immagine complessiva appare come un sottoinsieme F di E2 il cui centro di simmetria è posto sull'origine degli assi e si ha che posso ottenere ognuno dei Ti , con i = 1, ... , 2n , come immagine di T1 attraverso uno ed uno solo degli elementi di Dn, ovvero:
<br>
∀ i = 1, ... , 2n , ∃ ƒ ∈ Dn ∣ Ti = ƒ(T1)
<br>
<br>
Quindi le simmetrie di F = T1 U T2 U ... U T2n sono: <br>
	•	n riflessioni date dalle n rette che separano T1 , T2 , ... , T2n.<br>
	•	la rotazione ρ2α data dalla composizione della riflessione di asse l con quella di asse s, e tutte le rotazioni di angolo multiplo intero di 2α, che danno in totale n rotazioni dal momento che α = π/n.
Abbiamo quindi che Isom(F) è composto dalle n riflessioni e n rotazioni di Dn , cioè Isom(F) = Dn. 

</p>

    
</section>

        <section id="argomento4" class="content-section">
            <h2>Simboli</h2>
            <p>E2 = Piano Euclideo 
            <br>F = Figura, sottoinsieme del Piano Euclideo 
            <br>M = Isom(E) = Gruppo delle isometrie del piano 
            <br>tv = traslazione di vettore v
            <br>ρθ = Rotazione di centro l'origine e angolo θ.
            <br>rl =Riflessione di asse l passante per l'origine 
            <br>Isom(F) = { ƒ ∈ M | ƒ(F) = F } gruppo di simmetria della figura F
            <br>Cn = < ρ2π/n > = { 1, ρθ, ρθ2, ρθ3, ..., ρθn-1} gruppo generato da una rotazione di 2π/n
            <br>Dn = < ρ2π/n, rl > = { 1, ρθ, ρθ2, ... , ρθn-1 , rl , ρθ o rl , ρθ2 o rl , ... , ρθn-1 o rl } gruppo generato da una rotazione di 2π/n e una riflessione di asse l
</p>

            <h2>Sitografia</h2>
            <p>Introduzione storica: <a href="https://it.wikipedia.org/wiki/Caleidoscopio" target="_blank" rel="noopener noreferrer">Wikipedia - Caleidoscopio</a></p>
            <p>Funzionamento: <a href="https://www.giovaniperlascienza.it/site/le-nostre-attivita/attivita-1/il-caleidoscopio/" target="_blank" rel="noopener noreferrer">Giovani per la Scienza</a></p>
            <p>Gruppi di Coxeter: <a href="https://it.wikipedia.org/wiki/Gruppo_di_Coxeter" target="_blank" rel="noopener noreferrer">Wikipedia - Gruppo di Coxeter</a></p>
            <p>Video (esempio): <a href="https://www.youtube.com/watch?v=306MUlh054Y" target="_blank" rel="noopener noreferrer">YouTube - Esempio Caleidoscopio</a>,  <a href="https://www.youtube.com/watch?v=gz9BRl7DVSM"target="_blank" rel="noopener noreferrer"> YouTube - Esempio Caleidoscopio</a> 
            <p>Parte matematica: <a href="https://web.math.princeton.edu/~jl5270/talks/mathematicsInKaleidoscopes.pdf" target="_blank" rel="noopener noreferrer">Princeton University - Mathematics In Kaleidoscopes (PDF)</a></p>
            <p><a href="http://progettomatematica.dm.unibo.it/ROSONI/gruppi%20ciclici%204.htm" target="_blank" rel="noopener noreferrer"> Progetto matematica Unibo </a></p>
            <p><a href="http://dm.unife.it/matematicainsieme/simmetrie/approf016.htm" target="_blank" rel="noopener noreferrer"> Progetto simmetrie Unife  </a></p>
        </section>
    </div>

    <footer>
        <p>©️ Progetto a cura di Amadori Aurora e Nepi Lorenzo</p>
        <p>ISIA U - Anno accademico 2024/25</p>
    </footer>

    <script>
        const topMenuNav = document.querySelector('nav.top-menu');
        const homePageTitle = document.getElementById('homePageTitle'); 
        const pageFooter = document.querySelector('footer');
        const pageTitleContainer = document.querySelector('.page-title-container');


        let lastScrollTop = 0;
        const menuHeight = topMenuNav ? topMenuNav.offsetHeight : 60; 
        const scrollThreshold = 20; 

        window.addEventListener('scroll', function() {
            if (document.body.classList.contains('simulation-fullscreen')) { 
                if (topMenuNav) {
                     topMenuNav.style.top = "0";
                }
                return;
            }
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if (topMenuNav) {
                if (scrollTop > lastScrollTop && scrollTop > menuHeight + scrollThreshold) {
                    topMenuNav.style.top = `-${menuHeight + 20}px`; 
                } else if (scrollTop < lastScrollTop || scrollTop <= scrollThreshold) {
                    topMenuNav.style.top = "0"; 
                }
            }
            lastScrollTop = scrollTop <= 0 ? 0 : scrollTop; 
        }, false);


        const autoKaleidoscope = (function() { /* ... (codice simulazione automatica invariato) ... */ 
            let canvas, ctx, centerX, centerY;
            let simColorsInternal, numReflections, pieces, NUM_PIECES;
            let animationFrameId = null;
            let isInitialized = false;
            let isActive = false;
            let isTakingFullAvailableSpace = false; 
            const K_SIM_COLORS_INTERNAL = ["#FF5733", "#FFC300", "#DAF7A6", "#33FF57", "#33CFFF", "#A333FF", "#FF33A8", "#F06EAA"];
            const K_NUM_REFLECTIONS = 7; 
            const K_NUM_PIECES = 55;

            function setupCanvasDimensions() {
                if (!canvas || !topMenuNav) return;
                if (isTakingFullAvailableSpace) {
                    const currentMenuHeight = (topMenuNav && topMenuNav.style.display !== 'none') ? topMenuNav.offsetHeight : 0;
                    const currentTitleHeight = (homePageTitle && homePageTitle.style.display !== 'none') ? homePageTitle.offsetHeight : 0;
                    canvas.width = window.innerWidth;
                    canvas.height = window.innerHeight - currentMenuHeight - currentTitleHeight; 
                    canvas.style.border = "none"; 
                } else {
                    canvas.width = 500; 
                    canvas.height = 400;
                }
                centerX = canvas.width / 2;
                centerY = canvas.height / 2;
                 if (isActive) generatePiecesInternal(); 
            }
            function init(canvasElementId) {
                canvas = document.getElementById(canvasElementId);
                if (!canvas) { return; } 
                ctx = canvas.getContext('2d');
                simColorsInternal = K_SIM_COLORS_INTERNAL;
                numReflections = K_NUM_REFLECTIONS;
                pieces = [];
                NUM_PIECES = K_NUM_PIECES;
                isInitialized = true;
            }
            function generatePiecesInternal() {
                if (!isInitialized || !isActive || !ctx) return;
                pieces.length = 0; 
                const chamberRadius = Math.min(centerX, centerY) * 0.68;
                for (let i = 0; i < NUM_PIECES; i++) {
                    const type = Math.random() > 0.4 ? 'circle' : 'line'; 
                    const dist = Math.random() * chamberRadius;
                    const ang = Math.random() * Math.PI * 2;
                    pieces.push({
                        x: dist * Math.cos(ang), y: dist * Math.sin(ang), type: type,
                        r: type === 'circle' ? (Math.random() * 4.5 + 1) : (Math.random() * 1.8 + 0.5),
                        length: type === 'line' ? (Math.random() * 18 + 4) : 0,
                        angle: type === 'line' ? (Math.random() * Math.PI) : 0,
                        color: simColorsInternal[Math.floor(Math.random() * simColorsInternal.length)],
                        vx: (Math.random() - 0.5) * 0.20, vy: (Math.random() - 0.5) * 0.20,
                        va: type === 'line' ? (Math.random() - 0.5) * 0.0030 : 0
                    });
                }
            }
            function updatePiecesInternal() { 
                if (!isInitialized || !isActive) return;
                const chamberRadius = Math.min(centerX, centerY) * 0.72;
                const edgeSoftness = 0.1;
                pieces.forEach(piece => {
                    piece.x += piece.vx; piece.y += piece.vy;
                    if (piece.type === 'line') piece.angle += piece.va;
                    const distSq = piece.x * piece.x + piece.y * piece.y;
                    if (distSq > (chamberRadius * chamberRadius)) {
                        const ang = Math.random() * Math.PI * 2;
                        const newDist = Math.random() * chamberRadius * (1 - edgeSoftness);
                        piece.x = newDist * Math.cos(ang); piece.y = newDist * Math.sin(ang);
                        piece.vx = (Math.random() - 0.5) * 0.20; piece.vy = (Math.random() - 0.5) * 0.20;
                        piece.color = simColorsInternal[Math.floor(Math.random() * simColorsInternal.length)];
                        if (piece.type === 'circle') piece.r = Math.random() * 4.5 + 1;
                        else { piece.r = Math.random() * 1.8 + 0.5; piece.length = Math.random() * 18 + 4; }
                    }
                });
            }
            function drawKaleidoscopeInternal() { 
                if (!isInitialized || !isActive || !ctx) return;
                ctx.fillStyle = 'black'; 
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                for (let i = 0; i < numReflections; i++) {
                    ctx.save();
                    ctx.translate(centerX, centerY);
                    ctx.rotate((i * 2 * Math.PI) / numReflections);
                    if (i % 2 !== 0) ctx.scale(-1, 1);
                    pieces.forEach(piece => {
                        if (piece.type === 'circle') {
                            ctx.beginPath(); ctx.arc(piece.x, piece.y, piece.r, 0, Math.PI * 2);
                            ctx.fillStyle = piece.color; ctx.fill();
                        } else if (piece.type === 'line') {
                            ctx.save(); ctx.translate(piece.x, piece.y); ctx.rotate(piece.angle);
                            ctx.beginPath(); ctx.moveTo(-piece.length / 2, 0); ctx.lineTo(piece.length / 2, 0);
                            ctx.strokeStyle = piece.color; ctx.lineWidth = piece.r; ctx.lineCap = 'round'; ctx.stroke();
                            ctx.restore();
                        }
                    });
                    ctx.restore();
                }
            }
            function animationLoopInternal() {
                if (!isActive || !isInitialized) {
                    if (animationFrameId) cancelAnimationFrame(animationFrameId);
                    animationFrameId = null; return;
                }
                updatePiecesInternal(); drawKaleidoscopeInternal();
                animationFrameId = requestAnimationFrame(animationLoopInternal);
            }
            function handleResizeEvent() {
                if (isActive && isTakingFullAvailableSpace) setupCanvasDimensions();
            }
            function start(takeFullSpace = false) {
                if (!isInitialized) init('kaleidoscopeCanvas');
                if (!isInitialized || !canvas) return;
                isTakingFullAvailableSpace = takeFullSpace; isActive = true;
                if (animationFrameId) cancelAnimationFrame(animationFrameId);
                setupCanvasDimensions(); 
                canvas.onclick = generatePiecesInternal;
                if (isTakingFullAvailableSpace) window.addEventListener('resize', handleResizeEvent);
                else window.removeEventListener('resize', handleResizeEvent);
                generatePiecesInternal(); animationLoopInternal();
            }
            function stop() {
                isActive = false;
                if (animationFrameId) { cancelAnimationFrame(animationFrameId); animationFrameId = null; }
                if (canvas) canvas.onclick = null;
                window.removeEventListener('resize', handleResizeEvent);
            }
            return { init, start, stop };
        })();

        const interactiveKaleidoscopeLab = (function() { /* Lab p5.js principale, per argomento3 */
            let p5Instance = null; 
            let labIsActive = false;
            const sketchCode = function(p) { 
                let baseDrawing; let numSpicchi; let numSpicchiSlider; let numSpicchiDisplay;
                let bisectorAngleDisplay; let colorPicker; let strokeWeightSlider;
                let strokeWeightDisplay; let currentStrokeWeight = 4;
                const allowedSpicchiValues = [2, 4, 6, 8, 10, 12, 18, 20, 24];
                let currentSpicchiIndex = 2;
                p.setup = function() {
                    let canvasWidth = p.min(500, p.windowWidth * 0.5);
                    let canvasHeight = canvasWidth; 
                    let canvas = p.createCanvas(canvasWidth, canvasHeight); 
                    canvas.parent('p5CanvasContainer'); 
                    p.angleMode(p.DEGREES);

                    baseDrawing = p.createGraphics(p.width, p.height);
                    baseDrawing.clear();

                    numSpicchiSlider = p.select('#numSpicchiSlider-labMain'); 
                    if(numSpicchiSlider && numSpicchiSlider.elt) {
                        numSpicchiSlider.elt.min = 0;
                        numSpicchiSlider.elt.max = allowedSpicchiValues.length - 1;
                        numSpicchiSlider.elt.value = currentSpicchiIndex;
                        numSpicchiSlider.elt.step = 1;
                        numSpicchiSlider.input(() => { 
                            currentSpicchiIndex = numSpicchiSlider.value(); 
                            numSpicchi = allowedSpicchiValues[currentSpicchiIndex]; 
                            if(numSpicchiDisplay) numSpicchiDisplay.html(numSpicchi.toString()); 
                            updateBisectorAngleDisplayP5(); 
                        });
                    }

                    numSpicchiDisplay = p.select('#numSpicchiDisplay-labMain'); 
                    numSpicchi = allowedSpicchiValues[currentSpicchiIndex];
                    if(numSpicchiDisplay) numSpicchiDisplay.html(numSpicchi.toString());

                    bisectorAngleDisplay = p.select('#bisectorAngleDisplay-labMain'); 
                    updateBisectorAngleDisplayP5();

                    colorPicker = p.select('#colorPickerInput-labMain'); 
                    if (colorPicker) {
                        if (typeof colorPicker.value === 'function') colorPicker.value('#E74C3C');
                        else if (colorPicker.elt) colorPicker.elt.value = '#E74C3C';
                        else colorPicker.value = '#E74C3C'; 
                    }


                    strokeWeightSlider = p.select('#strokeWeightSlider-labMain'); 
                     if(strokeWeightSlider && strokeWeightSlider.elt) {
                        strokeWeightSlider.elt.min = 1;
                        strokeWeightSlider.elt.max = 20;
                        strokeWeightSlider.elt.value = currentStrokeWeight;
                        strokeWeightSlider.elt.step = 1;
                        strokeWeightSlider.input(() => { currentStrokeWeight = strokeWeightSlider.value(); if(strokeWeightDisplay) strokeWeightDisplay.html(currentStrokeWeight.toString()); });
                    }

                    strokeWeightDisplay = p.select('#strokeWeightDisplay-labMain'); 
                    if(strokeWeightDisplay) strokeWeightDisplay.html(currentStrokeWeight.toString());
                    
                    p.background(0); 
                };
                p.windowResized = function() { 
                    let canvasWidth = p.min(600, p.windowWidth * 0.9);
                    let canvasHeight = canvasWidth;
                    p.resizeCanvas(canvasWidth, canvasHeight);
                    let tempDrawing = p.createGraphics(p.width, p.height);
                    if (baseDrawing) { 
                        tempDrawing.image(baseDrawing, 0, 0, p.width, p.height); 
                    }
                    baseDrawing = tempDrawing;
                     p.background(0); 
                };
                function updateBisectorAngleDisplayP5() { if (numSpicchi > 0) { let angleBetweenBisectors = 360 / numSpicchi; if(bisectorAngleDisplay) bisectorAngleDisplay.html(angleBetweenBisectors.toFixed(1) + "°"); } else { if(bisectorAngleDisplay) bisectorAngleDisplay.html("N/A"); } }
                p.draw = function() {
                    p.background(0); 
                    if (p.mouseIsPressed && p.mouseY > 0 && p.mouseY < p.height && p.mouseX > 0 && p.mouseX < p.width) { 
                        let currentColorValue;
                        if (colorPicker) {
                           if (typeof colorPicker.value === 'function') currentColorValue = colorPicker.value();
                           else currentColorValue = colorPicker.value;
                        } else { currentColorValue = '#E74C3C'; }
                        let p5Col = p.color(currentColorValue);
                        baseDrawing.stroke(p.red(p5Col), p.green(p5Col), p.blue(p5Col)); 
                        baseDrawing.strokeWeight(currentStrokeWeight); 
                        baseDrawing.line(p.pmouseX, p.pmouseY, p.mouseX, p.mouseY);
                    }
                    p.translate(p.width / 2, p.height / 2); let anglePerSpicchio = 360 / numSpicchi;
                    if (numSpicchi > 0) {
                        p.push(); 
                        p.stroke(255, 255, 255, 120); 
                        p.strokeWeight(1); 
                        for (let i = 0; i < numSpicchi; i++) { 
                            let bisectorAngle = (i * anglePerSpicchio) + (anglePerSpicchio / 2); 
                            let x2 = p.cos(bisectorAngle) * (p.max(p.width, p.height) / 1.5); 
                            let y2 = p.sin(bisectorAngle) * (p.max(p.width, p.height) / 1.5); 
                            p.line(0, 0, x2, y2); 
                        }
                        p.pop();
                        for (let i = 0; i < numSpicchi; i++) { p.push(); p.rotate(i * anglePerSpicchio); if (i % 2 === 1) p.scale(1, -1); p.imageMode(p.CENTER); p.image(baseDrawing, 0, 0); p.pop(); }
                    }
                };
                p.keyPressed = function() { if (p.key === ' ') { baseDrawing.clear(); p.background(0); }}; 
            };
            function start() { 
                if (document.getElementById('p5CanvasContainer')) { 
                    if (p5Instance) {p5Instance.remove(); p5Instance = null;}
                    labIsActive = true; 
                    p5Instance = new p5(sketchCode, 'p5CanvasContainer');
                }
            }
            function stop() { 
                labIsActive = false; 
                if (p5Instance) { 
                    p5Instance.noLoop(); 
                    p5Instance.remove(); 
                    p5Instance = null;
                    const canvasContainer = document.getElementById('p5CanvasContainer');
                    if (canvasContainer) canvasContainer.innerHTML = '';
                }
            }
            return { start, stop };
        })();
        
        const p5StellaLab = (function() { 
            let p5Instance = null;
            let labIsActive = false;
            const sketchCodeStella = function(p) {
                let sliderStella; 
                p.setup = function() {
                    let canvasSize = p.min(400, p.windowWidth * 0.85); 
                    let stellaCanvas = p.createCanvas(canvasSize, canvasSize); 
                    stellaCanvas.parent('p5StellaCanvasContainer');
                    p.angleMode(p.DEGREES);
                    
                    let stellaControlsDiv = p.select('#p5StellaControlsContainer');
                    if (stellaControlsDiv) stellaControlsDiv.html(''); 

                    let labelP = p.createP("Numero di punte:");
                    labelP.parent(stellaControlsDiv);
                    labelP.style('color', '#D0D0D0'); 
                    labelP.style('margin', '0 5px 0 0');
                    sliderStella = p.createSlider(3, 30, 5, 1); 
                    sliderStella.parent(stellaControlsDiv);
                    sliderStella.style('width', '120px'); 
                };
                p.windowResized = function() { 
                    let canvasSize = p.min(400, p.windowWidth * 0.85);
                     p.resizeCanvas(canvasSize, canvasSize);
                };
                p.draw = function() {
                    p.background(0); 
                    p.translate(p.width / 2, p.height / 2 - p.height * 0.1); 

                    let n = sliderStella.value();
                    let angleStep = 360 / n;
                    let r = p.min(p.width, p.height) / 2 * 0.65; 
                    let innerR = r * 0.5;
                    p.noFill(); 
                    p.stroke(255);    
                    p.strokeWeight(1.5);
                    for (let i = 0; i < n; i++) {
                        p.push();
                        p.rotate(i * angleStep);
                        p.beginShape();
                        p.vertex(0, 0); 
                        p.vertex(p.cos(-angleStep / 2) * r, p.sin(-angleStep / 2) * r);
                        p.vertex(p.cos(0) * innerR, p.sin(0) * innerR); 
                        p.vertex(p.cos(angleStep / 2) * r, p.sin(angleStep / 2) * r);
                        p.endShape(p.CLOSE);
                        p.pop();
                    }
                    p.push();
                    p.noStroke();
                    p.fill(220); 
                    p.textAlign(p.CENTER, p.TOP); 
                    p.textSize(p.max(10, p.width / 30)); 
                    
                    let textBlockStartY = r + p.height * 0.05; 

                    p.text(n + " punte", 0, textBlockStartY);
                    p.pop();
                    
                    p.push();
                    p.stroke(255, 0, 0, 150); 
                    p.noFill();
                    p.strokeWeight(1);
                    p.arc(0, 0, r / 3, r / 3, -angleStep / 2, angleStep / 2); 
                    p.pop();
                };
            };
            function start() {
                if (document.getElementById('p5StellaCanvasContainer')) {
                    if (p5Instance) { p5Instance.remove(); p5Instance = null; }
                    const controlsContainer = document.getElementById('p5StellaControlsContainer');
                    if (controlsContainer) controlsContainer.innerHTML = '';
                    labIsActive = true;
                    p5Instance = new p5(sketchCodeStella, 'p5StellaCanvasContainer');
                }
            }
            function stop() {
                labIsActive = false;
                if (p5Instance) {
                    p5Instance.noLoop();
                    p5Instance.remove(); 
                    p5Instance = null;
                    const controlsContainer = document.getElementById('p5StellaControlsContainer');
                    if (controlsContainer) controlsContainer.innerHTML = '';
                     const canvasContainer = document.getElementById('p5StellaCanvasContainer');
                    if (canvasContainer) canvasContainer.innerHTML = '';
                }
            }
            return { start, stop };
        })();

        const menuLinks = document.querySelectorAll('nav.top-menu li a');
        const views = {
            simulationContainer: document.getElementById('simulationContainer'),
            argomento1: document.getElementById('argomento1'),
            argomento2: document.getElementById('argomento2'), 
            argomentoTassellatura: document.getElementById('argomentoTassellatura'),
            argomento3: document.getElementById('argomento3'), 
            argomento4: document.getElementById('argomento4')
        };

        function showView(targetId) { 
            Object.values(views).forEach(view => { if (view) view.style.display = 'none'; });
            menuLinks.forEach(link => link.classList.remove('active'));
            
            autoKaleidoscope.stop(); 
            interactiveKaleidoscopeLab.stop(); 
            p5StellaLab.stop(); 
            
            document.body.classList.remove('simulation-fullscreen'); 
            document.body.style.overflow = 'visible'; 

            if (pageFooter) pageFooter.style.display = 'none'; 
            if (homePageTitle) homePageTitle.style.display = 'none'; 
            const generalPageTitle = document.querySelector('.page-title-container');
             if (generalPageTitle) generalPageTitle.style.display = (targetId === 'simulationContainer' ? 'none' : 'block');


            if (topMenuNav) topMenuNav.style.display = 'flex';

            const targetViewLink = document.querySelector(`nav.top-menu li a[data-target="${targetId}"]`);
            if (targetViewLink) targetViewLink.classList.add('active');

            if (targetId === 'simulationContainer') {
                if (homePageTitle) homePageTitle.style.display = 'block'; 
                document.body.classList.add('simulation-fullscreen'); 
                document.body.style.overflow = 'hidden'; 
                views.simulationContainer.style.display = 'flex';
                autoKaleidoscope.start(true); 
            } else {
                const sectionToShow = views[targetId];
                if (sectionToShow) {
                    sectionToShow.style.display = 'block';
                    document.body.style.overflow = 'auto'; 
                    
                    if (targetId === 'argomento2') { 
                        document.body.style.overflow = 'auto'; 
                        p5StellaLab.start();
                    } else if (targetId === 'argomento3') { 
                        document.body.style.overflow = 'auto'; 
                        interactiveKaleidoscopeLab.start(); 
                    }

                    if (targetId === 'argomento4') { 
                        if (pageFooter) pageFooter.style.display = 'block';
                    }
                }
            }
        }
        
        menuLinks.forEach(link => {
            link.addEventListener('click', (event) => {
                event.preventDefault();
                const targetId = link.getAttribute('data-target');
                showView(targetId);
                if (targetId !== 'simulationContainer') {
                    const sectionElement = document.getElementById(targetId);
                    if (sectionElement) {
                        const menuHeight = topMenuNav ? topMenuNav.offsetHeight : 0;
                        const titleHeight = (pageTitleContainer && pageTitleContainer.style.display !== 'none') ? pageTitleContainer.offsetHeight : 0;
                        const totalOffset = menuHeight + titleHeight; 
                        const elementPosition = sectionElement.getBoundingClientRect().top + window.pageYOffset;
                        const scrollToPosition = elementPosition - totalOffset - 15; 
                        window.scrollTo({ top: Math.max(0, scrollToPosition), behavior: 'smooth' });
                    }
                }
            });
        });

        window.addEventListener('DOMContentLoaded', () => {
            autoKaleidoscope.init('kaleidoscopeCanvas'); 
            showView('simulationContainer'); 
        });
    </script>
</body>
</html>